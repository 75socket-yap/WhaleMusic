<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tech.whale.admin.dao.AdminNoticeIDao">

	<sql id="includeNoticeCnt">
	    <choose>
	        <when test="selNum == 1">
	            WHERE (ADMIN_ID LIKE '%' || #{sk} || '%')
	        </when>
	        <when test="selNum == 1">
	            WHERE (NOTICE_TITLE LIKE '%' || #{sk} || '%')
	        </when>
	        <otherwise>
	        </otherwise>
	    </choose>
	</sql>
	
	<sql id="includeNoticeList">
	    <choose>
	        <when test="selNum == 1">
	            AND (ADMIN_ID LIKE '%' || #{sk} || '%')
	        </when>
	        <when test="selNum == 2">
	            AND (NOTICE_TITLE LIKE '%' || #{sk} || '%')
	        </when>
	        <otherwise>
	        </otherwise>
	    </choose>
	</sql>
	
	
	<select id="selectNoticeCnt" parameterType="map" resultType="int">
        SELECT COUNT(*) FROM NOTICE_TABLE
        <include refid="includeNoticeCnt" />
    </select>
    
    <select id="adminNoticeList" resultType="com.tech.whale.admin.dto.AdminNoticeListDto">
	    SELECT *
	    FROM (
	        SELECT
	        	NOTICE_ID,
				NOTICE_GROUP,
				NOTICE_TITLE,
				ADMIN_ID,
				NOTICE_TEXT,
				NOTICE_DATE,
				NOTICE_STATUS,
				NOTICE_CNT,
				NOTICE_UPDATE,
	            ROW_NUMBER() OVER (ORDER BY NOTICE_ID DESC) AS RNUM
	        FROM NOTICE_TABLE
	    ) 
	    WHERE RNUM BETWEEN #{start} AND #{end}
		<include refid="includeNoticeList" />
	</select>
    
   
	
	
	
</mapper>